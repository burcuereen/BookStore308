{"version":3,"file":"cli.js","sourceRoot":"","sources":["../src/cli.ts"],"names":[],"mappings":"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","sourcesContent":["import * as commander from 'commander';\nimport { Hay } from './hay';\nimport { commands, aliases } from './commands';\nconst pkgInfo = require('../package.json');\n\nlet startTime: number = Date.now();\n\nexport interface HayCommandInstance {\n  run(): Promise<any>;\n  watch?(): Promise<void>;\n}\n\nexport interface HayCommand {\n  new (hay: Hay): HayCommandInstance;\n  options?: Function;\n}\n\nlet [node, hayCmd, name, ...endArgs] = process.argv;\n\nlet dividerIndex = endArgs.indexOf('--');\nlet args: string[] = endArgs.splice(0, dividerIndex === -1 ? endArgs.length : dividerIndex);\n\nif (dividerIndex > -1) {\n  endArgs.shift();\n}\n\ncommander.version(pkgInfo.version);\ncommander.usage('[command] [flags]');\ncommander.option('--config <file>', 'config file');\ncommander.option('--destination <dir>', 'output directory');\ncommander.option('--no-progress', 'removes progress bar from output');\ncommander.option('--posts-dir <dir>', 'posts directory');\ncommander.option('--quiet', ' only show errors in console');\ncommander.option('--source <dir>', 'source directory to build from');\n\nlet commandName = '';\n\nlet helpCommands = ['help', '--help', '-h'];\nif (helpCommands.includes(name)) {\n  name = 'help';\n\n  if (args.length) {\n    commander.on('--help', () => {\n      console.log(`hello ${name}`);\n    });\n  } else {\n    commander.on('--help', () => {\n      console.log(`hi`);\n    });\n  }\n\n  name = <string>args.shift();\n  args.push('--help');\n}\n\ncommandName = aliases[name] || name || 'bale';\n\nlet command: HayCommand = commands[commandName];\n(command && command.options) && command.options(commander);\n\nif (commandName === 'help' || args.includes('--help') || args.includes('-h')) {\n  commander.parse([node, hayCmd, commandName].concat(args));\n  commander.help();\n  process.exit(1);\n}\n\ncommander.parse([node, hayCmd, commandName].concat(args));\n(<any> commander).args = commander.args.concat(endArgs);\n\nif (!command) {\n  class NoCommand {\n    async run() {\n      return Promise.reject(`Command ${commandName} not found`);\n    }\n  }\n\n  command = NoCommand;\n}\n\nlet hay: Hay = new Hay(commander);\n\nif (command && commandName !== name && name) {\n  hay.reporter.log(`<dim>Using ${commandName} (alias ${name} => ${commandName})</dim>`);\n}\n\nhay.reporter.log(`<bold>${pkgInfo.name} ${commandName} v${pkgInfo.version}</bold>`);\n\nhay\n  .config\n  .loadConfig(commander)\n  .then(() => hay.run(command, startTime))\n  .catch((err: any) => console.error(err));\n"]}